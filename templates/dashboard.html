<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Labor Dashboard</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container-fluid">
    <div class="row">

        <!-- LEFT SIDEBAR -->
        <div class="col-md-3 bg-light min-vh-100 p-3">
            <h5 class="mb-3">Companies</h5>

            <div class="list-group">
                <a href="/" class="list-group-item list-group-item-action">
                    All Companies ({{ company_map|length }})
                </a>

                {% for comp in companies %}
                    <a href="/company/{{ comp }}"
                       class="list-group-item list-group-item-action
                       {% if selected_company == comp %}active{% endif %}">
                        {{ comp }}
                    </a>
                {% endfor %}
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="col-md-9 p-4">

            <h3 class="mb-3">Labor Dashboard</h3>

            <!-- REMINDERS -->
            {% if reminders %}
                <div class="alert alert-warning">
                    <strong>Please get ready for renewal:</strong>
                    <ul class="mb-0">
                        {% for emp in reminders %}
                            <li>
                                {{ emp.Name }} ({{ emp.Position }}, {{ emp.Company }})
                                â€“ expires in {{ emp.days_left }} days ({{ emp.Expiry }})
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% else %}
                <div class="alert alert-success">
                    All work permits are renewed ðŸŽ‰
                </div>
            {% endif %}

            <!-- TABLES -->
            {% for company, employees in company_map.items() %}
                <h5 class="mt-4">{{ company }}</h5>

                <table class="table table-bordered table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Expiry</th>
                            <th>Days Left</th>
                            <th>Status</th>
                            <th>Email</th>
                            <th>WhatsApp</th>
                            <th>Action</th>
                        </tr>
                    </thead>

                    <tbody>
                        {% for emp in employees %}
                            <tr
                                class="{% if emp.status == 'Expired' %}table-danger
                                       {% elif emp.status == 'Expiring Soon' %}table-warning{% endif %}">
                                <td>{{ emp.Name }}</td>
                                <td>{{ emp.Position }}</td>
                                <td>{{ emp.Expiry }}</td>
                                <td>{{ emp.days_left }}</td>
                                <td>{{ emp.status }}</td>
                                <td>{{ emp.Email }}</td>
                                <td>{{ emp.WhatsAppNumber }}</td>
